-- ‚öôÔ∏è Auto Teleport C·ªïng 1 (Safe & Optimized)
-- B·∫≠t sau 3 gi√¢y, t·ª± d·ª´ng sau 1 gi√¢y
-- √Åp d·ª•ng nguy√™n t·∫Øc: h·∫°n ch·∫ø thread, c√≥ cleanup, kh√¥ng leak

local Players = game:GetService("Players")
local p = Players.LocalPlayer

-- ‚öôÔ∏è C·∫•u h√¨nh
local START_DELAY = 3       -- th·ªùi gian ch·ªù tr∆∞·ªõc khi teleport
local HOLD_TIME = 1         -- gi·ªØ v·ªã tr√≠ trong bao l√¢u (gi√¢y)
local TELEPORT_POS = Vector3.new(18.8671, 0.3727, -114.8620) -- v·ªã tr√≠ c·ªïng
local HEIGHT_OFFSET = Vector3.new(0, 5, 0) -- cao h∆°n m·∫∑t ƒë·∫•t 5 ƒë∆°n v·ªã

-- ‚öôÔ∏è Tr·∫°ng th√°i qu·∫£n l√Ω
local Teleport1 = {
	active = false,
	thread = nil,
}

-- üßπ H√†m cleanup
function Teleport1:Stop()
	if not self.active then return end
	self.active = false

	if self.thread and coroutine.close then
		pcall(function() coroutine.close(self.thread) end)
	end
	self.thread = nil

	pcall(function() collectgarbage("collect") end)
	print("[AUTO TP1] üî¥ D·ª´ng teleport v√† d·ªçn d·∫πp.")
end

-- ‚öôÔ∏è H√†m ch√≠nh
local function StartTeleport()
	if Teleport1.active then
		warn("[AUTO TP1] ƒê√£ ƒëang ch·∫°y, b·ªè qua.")
		return
	end
	Teleport1.active = true
	print("[AUTO TP1] ‚è≥ S·∫Ω d·ªãch chuy·ªÉn t·ªõi C·ªïng 1 sau " .. START_DELAY .. " gi√¢y.")

	task.delay(START_DELAY, function()
		if not Teleport1.active then return end
		local chr = p.Character or p.CharacterAdded:Wait()
		local hrp = chr:FindFirstChild("HumanoidRootPart")

		if hrp then
			print("[AUTO TP1] üü¢ D·ªãch chuy·ªÉn t·ªõi C·ªïng 1...")
			pcall(function()
				hrp.CFrame = CFrame.new(TELEPORT_POS + HEIGHT_OFFSET)
				hrp.Velocity = Vector3.zero
			end)
		else
			warn("[AUTO TP1] ‚ö†Ô∏è Kh√¥ng t√¨m th·∫•y HumanoidRootPart.")
		end

		-- Gi·ªØ trong HOLD_TIME r·ªìi d·ª´ng
		task.wait(HOLD_TIME)
		print("[AUTO TP1] üî¥ D·ª´ng teleport sau " .. HOLD_TIME .. " gi√¢y.")
		Teleport1:Stop()
	end)
end

-- üü¢ Ch·∫°y
StartTeleport()

-- üõë C√≥ th·ªÉ d·ª´ng th·ªß c√¥ng b·∫•t c·ª© l√∫c n√†o
getgenv().StopAutoTP1 = function()
	Teleport1:Stop()
end
